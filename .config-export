#!/bin/bash

if [ $# -eq 1 ] && [ -d "$1" ]; then
    DESTINATION=$1
    DOTFILES=$(git ls-tree -r HEAD --name-only | sed -e ':a;N;$!ba;s/\n/ /g')
	read -p "This may overwrite existing files in your home directory. Are you sure? (y/n) " -n 1;
	echo ""
	if [[ $REPLY =~ ^[Yy]$ ]]; then
        rsync -vlR --relative --perms                           \
            --exclude ".git" --exclude ".config-export"         \
            --exclude ".config-update" --exclude "README.md"    \
            ${DOTFILES} ${DESTINATION} 2> /dev/null
	fi
else
    echo "Usage: ./config-export <destination>" 1>&2
fi

